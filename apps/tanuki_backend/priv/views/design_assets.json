{
	"_id": "_design/assets",

	"language": "javascript",

	"views": {
		"by_date": {
			"map": "function (doc) { var date = null; if (doc.exif_date) { date = doc.exif_date; } else if (doc.file_date) { date = doc.file_date; } else { date = doc.import_date; } emit(date, [doc.file_name, doc.sha256]); }"
		},
		"by_checksum": {
			"map": "function(doc) { if (doc.sha256) { emit(doc.sha256, doc.mimetype); } }"
		},
		"by_tag": {
			"map": "function (doc) { if (doc.tags && Array.isArray(doc.tags)) { var date = null; if (doc.exif_date) { date = doc.exif_date; } else if (doc.file_date) { date = doc.file_date; } else { date = doc.import_date; } doc.tags.forEach(function (tag) { emit(tag.toLowerCase(), [date, doc.file_name, doc.sha256]); }); } }"
		},
		"tags": {
			"map": "function (doc) { if (doc.tags && Array.isArray(doc.tags)) { doc.tags.forEach(function (tag) { emit(tag.toLowerCase(), 1); }); } }",
			"reduce": "_count"
		},
		"years": {
			"map": "function (doc) { if (doc.exif_date) { emit(doc.exif_date[0], 1); } else if (doc.file_date) { emit(doc.file_date[0], 1); } else { emit(doc.import_date[0], 1); } }",
			"reduce": "_count"
		}
	}
}
